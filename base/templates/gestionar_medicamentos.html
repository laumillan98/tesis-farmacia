{% extends "./base.html" %}

{% block title %}Gestión de Medicamentos{% endblock %}

{% block body %}
<div class="row" style="margin-top: 10px;">
  <div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
    <h2>Insertar Medicamento</h2>
    <div class="card">
      <div class="card-body">
        <form action="/registrarMedicamento/" method="POST">{% csrf_token %}
          <input name="idFarmacia" value="{{farmacia.id}}" hidden>
          <div class="form-group">
            <input type="text" id="txtNombre" name="txtNombre" class="form-control" placeholder="Nombre" minlength="5"
              maxlength="50" required>
          </div>
          <div class="form-group">
            <input type="text" style="margin-top: 10px;" id="txtDescription" name="txtDescription" class="form-control"
              placeholder="Descripción" minlength="5" maxlength="500" required>
          </div>
          <div class="form-group">
            <input type="number" style="margin-top: 10px" id="numCantidad" name="numCantidad" class="form-control"
              placeholder="Cantidad máxima por receta/compra" min="1" max="10" required>
          </div>
          <div class="form-group">
            <input type="text" style="margin-top: 10px" id="txtPrecio" name="txtPrecio" class="form-control"
              placeholder="Precio por unidad" min="1" max="200" required>
          </div>
          <div class="form-group" style="margin-top: 10px">
            <select class="form-select" aria-label="Default select example" name="txtRestriccion">
              <option value="" selected disabled>Seleccione Restricción</option>
              {% for tipo in tipo_medicamento %}
              <option value="{{ tipo.id_tipo_medicamento }}">{{ tipo.nombre }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-group" style="margin-top: 10px">
            <label>Seleccione origen:</label>
            <div class="form-check" style="margin-top: 5px">
              <input class="form-check-input" type="radio" name="radioOrigen" id="flexRadioDefault1" value="True">
              <label class="form-check-label" for="flexRadioDefault1">
                Natural
              </label>
            </div>
            <div class="form-check" style="margin-top: 5px">
              <input class="form-check-input" type="radio" name="radioOrigen" id="flexRadioDefault2" value="False">
              <label class="form-check-label" for="flexRadioDefault2">
                Fármaco
              </label>
            </div>
          </div>
          <div class="form-group" style="margin-top: 10px">
            <button type="submit" class="btn btn-success btn-block text-white">Guardar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-sm-12 col-md-6 col-lg-8 col-xl-8">
    <h2>Listado de Medicamentos</h2>
    <div class="table-responsive py-2">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Cantidad máxima por receta/compra</th>
            <th>Precio por unidad</th>
            <th>Origen</th>
            <th>Restricción</th>
            <th>Existencias</th>
            <th colspan="2">Opciones</th>
          </tr>
        </thead>
        <tbody>
          {% for m in medicamentos %}
          <tr>
            <td>{{forloop.counter}}</td>
            <td>{{m.id_medic.nombre}}</td>
            <td>{{m.id_medic.description}}</td>
            <td>{{m.id_medic.cant_max}}</td>
            <td>{{m.id_medic.precio_unidad}}</td>
            <td>
              {% if m.id_medic.origen_natural %}
              Natural
              {% else %}
              Fármaco
              {% endif %}
            </td>
            <td>{{m.id_medic.id_restriccion}}</td>
            <td>
              <div class="form-group existenciaData">
                <input value="{{farmacia.id}}" id="idFarmacia" hidden>
                <input value="{{m.id_medic.id_medic}}" class="uuid-medicamento" hidden>
                <div class="input-group mb-3" style="width:120px">
                  <button class="input-group-text decrementBtn" name="minus">-</button>
                  <input type="text" class="form-control text-center bg-white input-qty" disabled
                    value="{{m.existencia}}">
                  <button class="input-group-text incrementBtn">+</button>
                </div>
              </div>
            </td>
            <td><a href="editarMedicamento/{{m.id_medic.id_medic}}" class="btn btn-success">Editar</a></td>
            <td><a href="eliminarMedicamento/{{m.id_medic.id_medic}}" class="btn btn-danger btnEliminacion"
                style="--bs-btn-padding-x: .5rem;">Eliminar</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}